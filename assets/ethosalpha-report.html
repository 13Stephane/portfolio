<!-- ETHOSALPHA CULTURE HEALTH CARD (Updated)
Changes requested:
1) Removed the explainer paragraph beginning “The EthosAlpha Culture Health Card is an evidence-backed…”
2) Integrated Strategic Appropriateness Rationale into a box directly below the Culture Health Summary table.
3) Removed the standalone “Strategic Appropriateness Rationale” section.
-->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EthosAlpha – Culture Health Card</title>
  <style>
    :root{
      --ea-green-900:#27514E;
      --ea-green-700:#27514E;
      --ea-orange-600:#C16727;
      --ea-orange-100:#ffe7cf;

      --ink:#0b1220;
      --muted:#52606d;
      --paper:#ffffff;
      --surface:#f6fbf8;
      --border:rgba(11,18,32,.12);

      --radius-xl:18px;
      --radius-lg:14px;
      --shadow:0 10px 30px rgba(11,18,32,.10);
      --shadow-soft:0 6px 18px rgba(11,18,32,.08);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--ink);
      background:
        radial-gradient(1200px 600px at 10% -10%, rgba(39,81,78,.10), transparent 60%),
        radial-gradient(900px 500px at 90% 10%, rgba(193,103,39,.10), transparent 55%),
        linear-gradient(180deg, #f7fbf8 0%, #ffffff 55%, #f7fbf8 100%);
    }

    .wrap{max-width:1120px;margin:0 auto;padding:28px 18px 60px;}

    .hero{
      border-radius: calc(var(--radius-xl) + 6px);
      overflow:hidden;
      box-shadow: var(--shadow);
      background: var(--ea-green-900);
      color:#fff;
    }
    .hero-inner{
      padding:18px 22px 12px;
      display:flex;
      gap:18px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .brand{display:flex;gap:14px;align-items:flex-start;min-width:340px;}
    .logo{
      width:72px;height:72px;border-radius:18px;
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.16);
      display:grid;place-items:center;
      overflow:hidden;
      flex: 0 0 auto;
    }
    .logo img{width:70px;height:70px;object-fit:contain;display:block}

    .titleblock{display:flex; flex-direction:column; gap:8px;}
    .headline{
      display:flex;
      align-items:baseline;
      gap:12px;
      flex-wrap:wrap;
    }
    .company{
      font-size:30px;
      font-weight:900;
      letter-spacing:.2px;
      line-height:1.05;
    }
    .scorebig{
      font-size:30px;
      font-weight:900;
      letter-spacing:.2px;
      line-height:1.05;
      white-space:nowrap;
    }
    .scorebig .val{color: var(--ea-orange-600);}
    .subtitle{
      font-size:13px;
      color:rgba(255,255,255,.88);
      font-weight:700;
      letter-spacing:.2px;
    }

    .meta{
      display:grid;
      gap:8px;
      min-width:320px;
      justify-items:end;
      align-content:start;
    }
    @media (max-width: 920px){
      .meta{justify-items:start}
    }
    .pill{
      display:inline-flex;gap:8px;align-items:center;
      padding:8px 10px;border-radius:999px;
      background: rgba(255,255,255,.12);
      border:1px solid rgba(255,255,255,.16);
      font-size:12px;color:rgba(255,255,255,.92);
      white-space:nowrap;
    }
    .pill b{color:#fff;font-weight:700}

    .hero-note{
      padding:0 22px 16px;
      display:flex;flex-wrap:wrap;gap:10px;
    }

    .card{
      background: var(--paper);
      border:1px solid var(--border);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-soft);
      overflow:hidden;
    }
    .card-header{
      padding:14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      background: linear-gradient(90deg, rgba(39,81,78,.10), rgba(39,81,78,.03));
      border-bottom:1px solid var(--border);
    }
    .card-header h2{
      margin:0;
      font-size:14px;
      letter-spacing:.25px;
      text-transform:uppercase;
      color: var(--ea-green-700);
    }
    .tag{
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      background: var(--surface);
      color: var(--muted);
    }
    .card-body{padding:14px 16px}

    .grid{
      margin-top:14px;
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:14px;
    }
    @media (max-width: 920px){
      .grid{grid-template-columns:1fr}
    }

    table{
      width:100%;
      border-collapse:separate;
      border-spacing:0;
      overflow:hidden;
      border:1px solid var(--border);
      border-radius: var(--radius-lg);
    }
    th,td{
      padding:12px 12px;
      border-bottom:1px solid var(--border);
      vertical-align:top;
      font-size:13px;
    }
    th{
      text-align:left;
      font-size:12px;
      color: var(--muted);
      background: #fbfdfc;
      letter-spacing:.2px;
      text-transform:uppercase;
    }
    tr:last-child td{border-bottom:none}

    .score{font-weight:900;color: var(--ea-green-700);}
    .score.orange{color: var(--ea-orange-600);}

    .radarBox{
      border-radius: var(--radius-lg);
      border:1px solid var(--border);
      background:
        radial-gradient(circle at 50% 50%, rgba(193,103,39,.10), transparent 55%),
        radial-gradient(circle at 30% 30%, rgba(39,81,78,.10), transparent 60%),
        #ffffff;
      padding:12px;
    }
    .radarLegend{
      margin-top:10px;
      font-size:12px;
      color:var(--muted);
      display:grid;
      gap:6px;
    }
    .radarLegendRow{
      display:flex;
      justify-content:space-between;
      gap:12px;
      padding:4px 0;
      border-bottom:1px dashed rgba(11,18,32,.10);
    }
    .radarLegendRow:last-child{border-bottom:none}
    .radarLegendRow b{color:var(--ink)}

    .fracture{
      border:1px solid var(--border);
      border-radius: var(--radius-lg);
      padding:12px;
      background: linear-gradient(180deg, #ffffff, #fbfdfc);
      margin-bottom:10px;
    }
    .fracture h3{
      margin:0 0 6px 0;
      font-size:13px;
      display:flex;
      gap:8px;
      align-items:center;
      justify-content:space-between;
    }
    .badge{
      font-size:11px;
      padding:5px 8px;
      border-radius:999px;
      border:1px solid var(--border);
      background: var(--surface);
      color: var(--muted);
      white-space:nowrap;
    }
    .sev{display:inline-flex;gap:6px;align-items:center;font-weight:900;}
    .dot{width:10px;height:10px;border-radius:50%;background: var(--ea-orange-600);box-shadow:0 0 0 3px rgba(193,103,39,.14);}
    .dot.high{background:#c62828;box-shadow:0 0 0 3px rgba(198,40,40,.14)}
    .fracture p{margin:0;font-size:13px;color: var(--muted);line-height:1.45;}

    .ledger thead th:nth-child(1){width:18%}
    .ledger thead th:nth-child(5){width:16%}
    .elig{font-weight:900;color: var(--ea-green-700);}
    .elig.internal{color: var(--ea-orange-600);}
    .elig.no{color:#c62828;}

    .noteBox{
      margin-top:10px;
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius:var(--radius-lg);
      background:var(--surface);
      font-size:12px;
      color:var(--muted);
      line-height:1.5;
    }
    .noteBox h3{
      margin:0 0 6px 0;
      font-size:12px;
      letter-spacing:.2px;
      text-transform:uppercase;
      color: var(--ea-green-700);
    }

    .foot{margin-top:14px;color: var(--muted);font-size:12px;text-align:center;}

    @media print{
      body{background:#fff}
      .wrap{max-width:100%; padding:0}
      .hero,.card{box-shadow:none}
    }
  </style>
</head>

<body>
  <div class="wrap">

    <!-- HEADER -->
    <section class="hero">
      <div class="hero-inner">
        <div class="brand">
          <div class="logo" aria-label="EthosAlpha logo">
            <img src="ethosalpha-logo.png" alt="EthosAlpha logo">
          </div>

          <div class="titleblock">
            <div class="headline">
              <div id="companyTitle" class="company" contenteditable="true">Tesla, Inc.</div>
              <div class="scorebig">
                <span style="opacity:.85;">—</span>
                <span id="overallScoreBig" class="val">—</span>
                <span style="opacity:.92;">/ 5</span>
              </div>
            </div>

            <div class="subtitle">EthosAlpha Culture Health Card</div>
          </div>
        </div>

        <div class="meta">
          <div class="pill"><b>As-of</b> <span id="asOf" contenteditable="true">2025-12-23</span></div>
          <div class="pill"><b>Evidence window</b> <span id="windowPolicy" contenteditable="true">0–24m core; 24–36m context</span></div>
          <div class="pill"><b>Weights</b> <span id="weightsText">SA 0.33 • SO 0.34 • CO 0.33</span></div>
        </div>
      </div>

      <!-- Qualitative synthesis box (editable) -->
      <div class="hero-note">
        <div style="
          width:100%;
          border:1px solid rgba(255,255,255,.18);
          background: rgba(255,255,255,.10);
          border-radius: 14px;
          padding: 10px 12px;
        ">
          <div style="
            font-size:12px;
            font-weight:900;
            letter-spacing:.2px;
            text-transform:uppercase;
            color: rgba(255,255,255,.92);
            margin-bottom:6px;
          ">
            Qualitative synthesis (analyst-reviewed)
          </div>

          <div contenteditable="true" style="
            font-size:13px;
            line-height:1.5;
            color: rgba(255,255,255,.86);
          ">
            Summarize the cultural signature in 3–5 sentences: (1) core strengths enabling strategy, (2) key fractures across management–employee–customer
            evidence, (3) principal risks/opportunities and monitoring triggers. Keep it evidence-linked; avoid absolute claims.
          </div>
        </div>
      </div>
    </section>

    <!-- MAIN GRID -->
    <div class="grid">

      <!-- CULTURE HEALTH SUMMARY (with SA rationale box below) -->
      <section class="card">
        <div class="card-header">
          <h2>Culture Health Summary</h2>
          <span class="tag">Ranges + confidence; traceable to ledger</span>
        </div>
        <div class="card-body">
          <table aria-label="Culture Health Summary">
            <thead>
              <tr>
                <th>Axis</th>
                <th>Range</th>
                <th>Confidence</th>
                <th>Interpretation</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><b>Strategic Appropriateness</b></td>
                <td class="score" contenteditable="true" data-range="sa">4.0–4.6</td>
                <td contenteditable="true">High</td>
                <td contenteditable="true">Culture supports the declared strategic posture and operating model; trade-offs are explicit and monitored.</td>
              </tr>
              <tr>
                <td><b>Soundness</b> (innovation-enabling)</td>
                <td class="score orange" contenteditable="true" data-range="so">2.8–3.6</td>
                <td contenteditable="true">Medium</td>
                <td contenteditable="true">Derived from the Innovation Culture Profile (weighted); resilience constraints identified.</td>
              </tr>
              <tr>
                <td><b>Congruence</b> (intent vs reality)</td>
                <td class="score orange" contenteditable="true" data-range="co">3.0–3.8</td>
                <td contenteditable="true">Medium</td>
                <td contenteditable="true">Cross-source alignment check (management vs employee vs customer evidence), including contradictions and variance.</td>
              </tr>
            </tbody>
          </table>

          <!-- Strategic Appropriateness rationale integrated here -->
          <div class="noteBox" style="margin-top:12px;">
            <h3>Strategic Appropriateness rationale</h3>
            <div style="display:grid; gap:10px;">
              <div>
                <b>Declared posture (from disclosures):</b>
                <span contenteditable="true">Rapid innovation + industrial scaling; time-to-market emphasis; vertical integration.</span>
              </div>
              <div>
                <b>Culture requirements (ruleset):</b>
                <span contenteditable="true">Fast decision loops; high ownership; escalating coordination discipline as scale increases; tolerance for ambiguity with clear escalation paths.</span>
              </div>
              <div>
                <b>Fit signals (evidence-backed):</b>
                <span contenteditable="true">Mission clarity and performance norms support speed; strong technical ambition; bias to action in engineering and delivery.</span>
              </div>
              <div>
                <b>Constraints / execution risks:</b>
                <span contenteditable="true">Sustained pressure may degrade psychological safety and retention; cross-functional handoffs risk bottlenecks; service quality lag can create trust drag.</span>
              </div>
              <div>
                <b>Monitoring triggers:</b>
                <span contenteditable="true">Attrition/tenure shifts; safety/quality incidents; review sentiment breakpoints; customer service backlog/escalations; leadership churn.</span>
              </div>
            </div>
            <div style="margin-top:8px;">
              <b>Method note:</b> SA is strategy–culture fit in context (not “culture niceness”). The supporting and contradicting items are recorded in the claim–evidence ledger.
            </div>
          </div>

          <div class="noteBox">
            <b>Linkage:</b> Soundness is derived from the Innovation Culture Profile (dimension-level weighted composite). Congruence reflects alignment across
            management, employee, and customer evidence. Strategic Appropriateness reflects culture–strategy fit in context.
          </div>

          <div style="height:12px"></div>

          <table aria-label="Score History">
            <thead>
              <tr>
                <th>Year</th>
                <th>Overall score</th>
                <th>Change</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody id="scoreHistoryBody">
              <tr>
                <td contenteditable="true">2023</td>
                <td contenteditable="true">—</td>
                <td contenteditable="true">—</td>
                <td contenteditable="true">Baseline year for this company.</td>
              </tr>
              <tr>
                <td contenteditable="true">2024</td>
                <td contenteditable="true">—</td>
                <td contenteditable="true">—</td>
                <td contenteditable="true">Update annually using the same window policy and versioned ledger.</td>
              </tr>
              <tr>
                <td contenteditable="true">2025</td>
                <td contenteditable="true">—</td>
                <td contenteditable="true">—</td>
                <td contenteditable="true">Snapshot as-of 2025-12-23.</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- INNOVATION RADAR + FRACTURES -->
      <section class="card">
        <div class="card-header">
          <h2>Innovation Culture Profile</h2>
          <span class="tag">Radar uses embedded score ranges</span>
        </div>
        <div class="card-body">
          <div class="radarBox">
            <svg id="radarSvg" width="100%" viewBox="0 0 520 300" role="img" aria-label="Innovation culture radar"></svg>
            <div id="radarLegend" class="radarLegend"></div>
          </div>

          <div class="noteBox">
            <div style="font-weight:900; color:var(--ea-green-700); text-transform:uppercase; letter-spacing:.2px; margin-bottom:4px;">
              Confidence logic (innovation dimensions)
            </div>
            Confidence reflects (i) <b>data density</b> (eligible items in the 0–24m core window), (ii) <b>cross-source corroboration</b>,
            (iii) <b>specificity</b> (behavior-linked excerpts vs generic sentiment), and (iv) <b>variance</b> (contradictions across teams/time).
            Low confidence indicates thin, noisy, or highly divergent evidence.
          </div>

          <div style="height:12px"></div>

          <div class="card-header" style="border-radius:var(--radius-lg); border:1px solid var(--border); background:#fff;">
            <h2 style="margin:0; font-size:13px; letter-spacing:.2px; text-transform:none; color:var(--ink);">Culture Fractures</h2>
            <span class="tag" style="background:var(--ea-orange-100); color:var(--ea-orange-600); border-color:rgba(193,103,39,.25);">Actionable tensions</span>
          </div>

          <div style="height:10px"></div>

          <div class="fracture">
            <h3>
              <span>F1 — Innovation intensity vs work-life sustainability</span>
              <span class="badge"><span class="sev"><span class="dot high"></span>High</span> • Structural</span>
            </h3>
            <p contenteditable="true">Burnout and retention risk may undermine psychological safety and consistent execution under ramp conditions.</p>
          </div>

          <div class="fracture">
            <h3>
              <span>F2 — Mission narrative vs service experience</span>
              <span class="badge"><span class="sev"><span class="dot"></span>Medium</span> • Medium-term</span>
            </h3>
            <p contenteditable="true">Customer support responsiveness is a recurring pain point; risk to trust and brand advocacy.</p>
          </div>
        </div>
      </section>

      <!-- CLAIM–EVIDENCE LEDGER -->
      <section class="card" style="grid-column: 1 / -1;">
        <div class="card-header">
          <h2>Claim–Evidence Ledger</h2>
          <span class="tag">Evidence + counter-evidence + SFDR/UK SDR use tagging</span>
        </div>
        <div class="card-body">
          <table class="ledger" aria-label="Claim Evidence Ledger">
            <thead>
              <tr>
                <th>Claim ID & statement</th>
                <th>Evidence (excerpt)</th>
                <th>Counter-evidence</th>
                <th>Regulatory use</th>
                <th>Disclosure eligibility</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td contenteditable="true"><b>C-MD-01</b> Mission framed as accelerating sustainable energy transition.</td>
                <td contenteditable="true">Official disclosure excerpt (replace with verbatim + ref).</td>
                <td contenteditable="true">—</td>
                <td contenteditable="true">SFDR: sustainability risk narrative / stewardship context</td>
                <td class="elig" contenteditable="true">Eligible</td>
              </tr>
              <tr>
                <td contenteditable="true"><b>C-EMP-01</b> High pressure suggests reduced psychological safety in pockets.</td>
                <td contenteditable="true">Employee review snippet(s) (replace with verbatim excerpts + dates).</td>
                <td contenteditable="true">Positive team-level reports; speak-up policy signals.</td>
                <td contenteditable="true">SFDR: human capital / conduct risk input</td>
                <td class="elig internal" contenteditable="true">Internal only</td>
              </tr>
              <tr>
                <td contenteditable="true"><b>C-CUST-01</b> Service responsiveness dissatisfaction despite strong product sentiment.</td>
                <td contenteditable="true">Customer review snippet(s) (replace with verbatim excerpts + dates).</td>
                <td contenteditable="true">Positive delivery/ownership experiences in subset of reviews.</td>
                <td contenteditable="true">Stewardship trigger (operational risk)</td>
                <td class="elig internal" contenteditable="true">Internal only</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

    </div>

    <!-- DATA COVERAGE MOVED TO BOTTOM -->
    <section class="card" style="margin-top:14px;">
      <div class="card-header">
        <h2>Data Coverage & Density</h2>
        <span class="tag">Methodological transparency (counts calibrate confidence)</span>
      </div>
      <div class="card-body">
        <table aria-label="Data Coverage">
          <thead>
            <tr>
              <th>Source</th>
              <th>Core (0–24m)</th>
              <th>Context (24–36m)</th>
              <th>Date range</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><b>Employee</b> (Glassdoor)</td>
              <td data-count="emp_glass_core">—</td>
              <td data-count="emp_glass_ctx">—</td>
              <td data-date="emp_glass_range">—</td>
              <td contenteditable="true">Role/geography coverage notes; sampling method</td>
            </tr>
            <tr>
              <td><b>Employee</b> (Indeed)</td>
              <td data-count="emp_indeed_core">—</td>
              <td data-count="emp_indeed_ctx">—</td>
              <td data-date="emp_indeed_range">—</td>
              <td contenteditable="true">Sampling notes; language filters</td>
            </tr>
            <tr>
              <td><b>Customer</b> (Trustpilot)</td>
              <td data-count="cust_tp_core">—</td>
              <td data-count="cust_tp_ctx">—</td>
              <td data-date="cust_tp_range">—</td>
              <td contenteditable="true">Platform bias caveats; country scope</td>
            </tr>
            <tr>
              <td><b>Customer</b> (Google)</td>
              <td data-count="cust_google_core">—</td>
              <td data-count="cust_google_ctx">—</td>
              <td data-date="cust_google_range">—</td>
              <td contenteditable="true">Coverage by location/store; sampling constraints</td>
            </tr>
            <tr>
              <td><b>Management</b> (Annual report / MD&A)</td>
              <td colspan="2" data-doc="mgmt_doc">—</td>
              <td data-date="mgmt_doc_range">—</td>
              <td contenteditable="true">Document ref + retrieval date retained in ledger</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <div class="foot">
      <div contenteditable="true">
        Note: “As-of” reflects a point-in-time snapshot. Update annually using the same window policy (0–24m core; 24–36m context). Preserve timestamps, hashes,
        ruleset versions, and human review outcomes for auditability.
      </div>
    </div>

  </div>

  <script>
    const EA_DATA = {
      meta: {
        as_of: "2025-12-23",
        window_policy: "0–24m core; 24–36m context",
        weights: { sa: 0.33, so: 0.34, co: 0.33 }
      },
      innovation_dimensions: {
        psychSafety:   { low: 2.0, high: 3.0, confidence: "Medium" },
        growthMindset: { low: 3.8, high: 4.6, confidence: "Medium" },
        meaning:       { low: 4.2, high: 4.8, confidence: "High" },
        infoFlow:      { low: 2.6, high: 3.4, confidence: "Medium" }
      },
      data_coverage: {
        employee: {
          glassdoor: { core: 420, context: 180, date_min: "2022-01-01", date_max: "2025-12-23" },
          indeed:    { core: 310, context:  95, date_min: "2022-01-01", date_max: "2025-12-23" }
        },
        customer: {
          trustpilot: { core: 1200, context: 500, date_min: "2022-01-01", date_max: "2025-12-23" },
          google:     { core:  860, context: 300, date_min: "2022-01-01", date_max: "2025-12-23" }
        },
        management: {
          doc: "Annual report / MD&A – retrieved 2025-12-23",
          date_min: "2025-12-23",
          date_max: "2025-12-23"
        }
      }
    };

    function mid(d){ return (d.low + d.high) / 2; }
    function clamp(x, a, b){ return Math.max(a, Math.min(b, x)); }
    function parseRange(text){
      const t = (text || "").replace(/\s/g,'').replace('—','');
      const parts = t.split(/[–-]/);
      if(parts.length !== 2) return null;
      const a = parseFloat(parts[0]);
      const b = parseFloat(parts[1]);
      if(Number.isNaN(a) || Number.isNaN(b)) return null;
      return { low: a, high: b, mid: (a+b)/2 };
    }
    function polar(cx, cy, r, angleRad){
      return { x: cx + r * Math.cos(angleRad), y: cy + r * Math.sin(angleRad) };
    }

    function fillCoverage(){
      const cov = EA_DATA.data_coverage;
      const setCount = (attr, val) => {
        const el = document.querySelector(`[data-count="${attr}"]`);
        if(el) el.textContent = (val === null || val === undefined) ? "—" : String(val);
      };
      const setDate = (attr, val) => {
        const el = document.querySelector(`[data-date="${attr}"]`);
        if(el) el.textContent = val || "—";
      };
      const setDoc = (attr, val) => {
        const el = document.querySelector(`[data-doc="${attr}"]`);
        if(el) el.textContent = val || "—";
      };

      setCount("emp_glass_core", cov.employee.glassdoor.core);
      setCount("emp_glass_ctx",  cov.employee.glassdoor.context);
      setDate("emp_glass_range", `${cov.employee.glassdoor.date_min} → ${cov.employee.glassdoor.date_max}`);

      setCount("emp_indeed_core", cov.employee.indeed.core);
      setCount("emp_indeed_ctx",  cov.employee.indeed.context);
      setDate("emp_indeed_range", `${cov.employee.indeed.date_min} → ${cov.employee.indeed.date_max}`);

      setCount("cust_tp_core", cov.customer.trustpilot.core);
      setCount("cust_tp_ctx",  cov.customer.trustpilot.context);
      setDate("cust_tp_range", `${cov.customer.trustpilot.date_min} → ${cov.customer.trustpilot.date_max}`);

      setCount("cust_google_core", cov.customer.google.core);
      setCount("cust_google_ctx",  cov.customer.google.context);
      setDate("cust_google_range", `${cov.customer.google.date_min} → ${cov.customer.google.date_max}`);

      setDoc("mgmt_doc", cov.management.doc);
      setDate("mgmt_doc_range", `${cov.management.date_min} → ${cov.management.date_max}`);
    }

    function computeOverallScore(){
      const weights = EA_DATA.meta.weights;

      const saEl = document.querySelector('[data-range="sa"]');
      const soEl = document.querySelector('[data-range="so"]');
      const coEl = document.querySelector('[data-range="co"]');

      const sa = parseRange(saEl?.innerText || "");
      const so = parseRange(soEl?.innerText || "");
      const co = parseRange(coEl?.innerText || "");

      const weightsEl = document.getElementById("weightsText");
      if(weightsEl){
        weightsEl.textContent = `SA ${weights.sa.toFixed(2)} • SO ${weights.so.toFixed(2)} • CO ${weights.co.toFixed(2)}`;
      }

      if(!sa || !so || !co){
        document.getElementById('overallScoreBig').innerText = "—";
        return;
      }

      const overall = (weights.sa*sa.mid) + (weights.so*so.mid) + (weights.co*co.mid);
      const rounded = Math.round(overall * 10) / 10;
      document.getElementById('overallScoreBig').innerText = rounded.toFixed(1);
    }

    function drawRadar(svgId, legendId, dims){
      const svg = document.getElementById(svgId);
      const legend = document.getElementById(legendId);
      if(!svg || !legend) return;

      svg.innerHTML = "";
      legend.innerHTML = "";

      const labels = [
        { key: "psychSafety", label: "Psychological Safety" },
        { key: "growthMindset", label: "Growth Mindset" },
        { key: "meaning", label: "Meaning / Mission" },
        { key: "infoFlow", label: "Roles & Info Flow" }
      ];

      const cx = 190, cy = 150;
      const R  = 110;
      const levels = 5;
      const startAngle = -Math.PI/2;

      const gridStroke = "rgba(11,18,32,.18)";
      const axisStroke = "rgba(11,18,32,.22)";
      const polyFill   = "rgba(193,103,39,.22)";
      const polyStroke = "rgba(193,103,39,.95)";
      const pointFill  = "rgba(39,81,78,.95)";

      function el(name, attrs){
        const e = document.createElementNS("http://www.w3.org/2000/svg", name);
        for(const k in attrs) e.setAttribute(k, attrs[k]);
        svg.appendChild(e);
        return e;
      }

      for(let lv=1; lv<=levels; lv++){
        const rr = (lv/levels)*R;
        let d = "";
        labels.forEach((L, i) => {
          const ang = startAngle + i*(2*Math.PI/labels.length);
          const p = polar(cx, cy, rr, ang);
          d += (i===0 ? `M ${p.x} ${p.y}` : ` L ${p.x} ${p.y}`);
        });
        d += " Z";
        el("path", { d, fill:"none", stroke:gridStroke, "stroke-width":"1" });

        const pLv = polar(cx, cy, rr, startAngle + Math.PI);
        const t = el("text", { x:pLv.x-18, y:pLv.y+4, fill:"rgba(82,96,109,.95)", "font-size":"11" });
        t.textContent = String(lv);
      }

      labels.forEach((L, i) => {
        const ang = startAngle + i*(2*Math.PI/labels.length);
        const pOuter = polar(cx, cy, R, ang);
        el("line", { x1:cx, y1:cy, x2:pOuter.x, y2:pOuter.y, stroke:axisStroke, "stroke-width":"1.2" });

        const pLab = polar(cx, cy, R+20, ang);
        const txt = el("text", { x:pLab.x, y:pLab.y, fill:"rgba(11,18,32,.85)", "font-size":"12", "font-weight":"700" });
        const anchor = (Math.cos(ang) > 0.2) ? "start" : (Math.cos(ang) < -0.2 ? "end" : "middle");
        txt.setAttribute("text-anchor", anchor);
        txt.textContent = L.label;
      });

      const points = labels.map((L, i) => {
        const ang = startAngle + i*(2*Math.PI/labels.length);
        const m = clamp(mid(dims[L.key]), 0, 5);
        const rr = (m/5)*R;
        return polar(cx, cy, rr, ang);
      });

      let dp = "";
      points.forEach((p,i) => { dp += (i===0 ? `M ${p.x} ${p.y}` : ` L ${p.x} ${p.y}`); });
      dp += " Z";
      el("path", { d:dp, fill:polyFill, stroke:polyStroke, "stroke-width":"2.2" });

      points.forEach((p) => el("circle", { cx:p.x, cy:p.y, r:"4.2", fill:pointFill, stroke:"#fff", "stroke-width":"1.6" }));

      labels.forEach((L) => {
        const d = dims[L.key];
        const m = Math.round(mid(d)*10)/10;
        const row = document.createElement("div");
        row.className = "radarLegendRow";
        row.innerHTML = `
          <span><b>${L.label}:</b> ${d.low.toFixed(1)}–${d.high.toFixed(1)} (mid ${m.toFixed(1)})</span>
          <span style="white-space:nowrap;">Confidence: <b>${d.confidence}</b></span>
        `;
        legend.appendChild(row);
      });
    }

    function init(){
      fillCoverage();
      drawRadar("radarSvg", "radarLegend", EA_DATA.innovation_dimensions);
      computeOverallScore();

      document.addEventListener('input', (e) => {
        if(e.target && e.target.matches('[data-range]')) computeOverallScore();
      });
    }

    init();
  </script>
</body>
</html>
